{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Eazhilamuthan/Documents/ReactProject/e-com/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/Eazhilamuthan/Documents/ReactProject/e-com/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapshotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(userSaga);import{takeLatest,put,all,call}from\"@redux-saga/core/effects\";import userActionTypes from\"./user.types\";import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from\"../../Components/firebase/firebase-utils\";import{signInFailure,signInSuccess,signOutFailure,signOutSuccess,signUpFailure,signUpSuccess}from\"./user.action\";export function getSnapshotFromUserAuth(userAuth){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapshotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signInFailure(_context.t0.message));case 15:;case 16:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);};export function signUp(_ref){var _ref$payload,email,password,displayName,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password,displayName=_ref$payload.displayName;_context2.prev=1;_context2.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context2.sent;user=_yield$auth$createUse.user;_context2.next=8;return put(signUpSuccess({user:user,additionalData:{displayName:displayName}}));case 8:_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);_context2.next=14;return put(signUpFailure(_context2.t0.message));case 14:case\"end\":return _context2.stop();}}},_marked2,null,[[1,10]]);}export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context3.sent;user=_yield$auth$signInWit.user;_context3.next=7;return getSnapshotFromUserAuth(user);case 7:_context3.next=13;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);_context3.next=13;return put(signInFailure(_context3.t0.message));case 13:;case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[0,9]]);};export function signInWithEmail(_ref2){var _ref2$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_ref2$payload=_ref2.payload,email=_ref2$payload.email,password=_ref2$payload.password;_context4.prev=1;_context4.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context4.sent;user=_yield$auth$signInWit2.user;_context4.next=8;return getSnapshotFromUserAuth(user);case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](1);_context4.next=14;return put(signInFailure(_context4.t0));case 14:;case 15:case\"end\":return _context4.stop();}}},_marked4,null,[[1,10]]);};export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return getCurrentUser();case 3:userAuth=_context5.sent;if(userAuth){_context5.next=6;break;}return _context5.abrupt(\"return\");case 6:_context5.next=8;return getSnapshotFromUserAuth(userAuth);case 8:_context5.next=14;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](0);_context5.next=14;return put(signInFailure(_context5.t0));case 14:case\"end\":return _context5.stop();}}},_marked5,null,[[0,10]]);}export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return auth.signOut();case 3:_context6.next=5;return put(signOutSuccess());case 5:_context6.next=11;break;case 7:_context6.prev=7;_context6.t0=_context6[\"catch\"](0);_context6.next=11;return put(signOutFailure(_context6.t0));case 11:case\"end\":return _context6.stop();}}},_marked6,null,[[0,7]]);}//export function* onSignInAfterSignUp({payload: {user, additionalData}}) {\n//  yield getSnapshotFromUserAuth(user, additionalData)\n//};\nexport function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(userActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context7.stop();}}},_marked7);};export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(userActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);};export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(userActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);};export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(userActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context10.stop();}}},_marked10);};export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(userActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context11.stop();}}},_marked11);}//export function* onSignUpSuccess() {\n//yield takeLatest(userActionTypes.SIGN_UP_SUCCESS, onSignInAfterSignUp)\n//}\nexport function userSaga(){return _regeneratorRuntime.wrap(function userSaga$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(onCheckUserSession),call(onSignOutStart),call(onSignUpStart)//call(onSignUpSuccess)\n]);case 2:case\"end\":return _context12.stop();}}},_marked12);};","map":{"version":3,"sources":["C:/Users/Eazhilamuthan/Documents/ReactProject/e-com/client/src/react/user/user.saga.js"],"names":["getSnapshotFromUserAuth","signUp","signInWithGoogle","signInWithEmail","isUserAuthenticated","signOut","onSignUpStart","onGoogleSignInStart","onEmailSignInStart","onCheckUserSession","onSignOutStart","userSaga","takeLatest","put","all","call","userActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","signInFailure","signInSuccess","signOutFailure","signOutSuccess","signUpFailure","signUpSuccess","userAuth","userRef","get","userSnapshot","id","data","message","payload","email","password","displayName","createUserWithEmailAndPassword","user","additionalData","signInWithPopup","signInWithEmailAndPassword","SIGN_UP_START","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from \"@redux-saga/core/effects\";\r\n\r\nimport userActionTypes from \"./user.types\";\r\n\r\nimport { auth, googleProvider, createUserProfileDocument, getCurrentUser } from \"../../Components/firebase/firebase-utils\";\r\nimport { signInFailure, signInSuccess, signOutFailure, signOutSuccess, signUpFailure, signUpSuccess } from \"./user.action\";\r\n\r\nexport function* getSnapshotFromUserAuth(userAuth) {\r\n    try{\r\n        const userRef = yield call(createUserProfileDocument, userAuth)\r\n        const userSnapshot = yield userRef.get();\r\n        yield put(\r\n            signInSuccess({id: userSnapshot.id, ...userSnapshot.data()})\r\n        );\r\n       } catch (error) {\r\n        yield put(\r\n            signInFailure(error.message)\r\n        );\r\n       };\r\n};\r\n\r\nexport function* signUp({ payload: { email, password, displayName } }) {\r\n    try {\r\n      const { user } = yield auth.createUserWithEmailAndPassword(email, password);\r\n      yield put(signUpSuccess({ user, additionalData: { displayName } }));\r\n    } catch (error) {\r\n      yield put(signUpFailure(error.message));\r\n    }\r\n  }\r\n\r\nexport function* signInWithGoogle() {\r\n   try{\r\n    const {user} = yield auth.signInWithPopup(googleProvider)\r\n    yield getSnapshotFromUserAuth(user)\r\n   } catch (error) {\r\n    yield put(\r\n        signInFailure(error.message)\r\n    );\r\n   };\r\n};\r\n\r\nexport function* signInWithEmail({payload: {email, password}}) {\r\n    try {\r\n        const {user} = yield auth.signInWithEmailAndPassword(email, password)\r\n        yield getSnapshotFromUserAuth(user)\r\n    } catch (error) {\r\n        yield put(\r\n            signInFailure(error)\r\n        );\r\n    };\r\n};\r\n\r\nexport function* isUserAuthenticated() {\r\n    try {\r\n      const userAuth = yield getCurrentUser();\r\n      if (!userAuth) return;\r\n      yield getSnapshotFromUserAuth(userAuth);\r\n    } catch (error) {\r\n      yield put(signInFailure(error));\r\n    }\r\n}\r\n\r\nexport function* signOut() {\r\n    try {\r\n        yield auth.signOut();\r\n        yield put(signOutSuccess())\r\n    } catch (error) {\r\n        yield put(\r\n            signOutFailure(error)\r\n        )\r\n    }\r\n}\r\n\r\n//export function* onSignInAfterSignUp({payload: {user, additionalData}}) {\r\n  //  yield getSnapshotFromUserAuth(user, additionalData)\r\n//};\r\n\r\nexport function* onSignUpStart() {\r\n    yield takeLatest(userActionTypes.SIGN_UP_START, signUp);\r\n};\r\n\r\nexport function* onGoogleSignInStart() {\r\n    yield takeLatest(userActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle)\r\n};\r\n\r\nexport function* onEmailSignInStart() {\r\n    yield takeLatest(userActionTypes.EMAIL_SIGN_IN_START, signInWithEmail)\r\n};\r\n\r\nexport function* onCheckUserSession() {\r\n    yield takeLatest(userActionTypes.CHECK_USER_SESSION, isUserAuthenticated)\r\n};\r\n\r\nexport function* onSignOutStart() {\r\n    yield takeLatest(userActionTypes.SIGN_OUT_START, signOut)\r\n}\r\n\r\n//export function* onSignUpSuccess() {\r\n    //yield takeLatest(userActionTypes.SIGN_UP_SUCCESS, onSignInAfterSignUp)\r\n//}\r\n\r\n\r\nexport function* userSaga() {\r\n    yield all([\r\n        call(onGoogleSignInStart), \r\n        call(onEmailSignInStart), \r\n        call(onCheckUserSession),\r\n        call(onSignOutStart),\r\n        call(onSignUpStart),\r\n        //call(onSignUpSuccess)\r\n    ]);\r\n};"]},"metadata":{},"sourceType":"module"}